{"version":3,"sources":["WebSocketProxy.tsx","SettingDialog.tsx","TimeoutFullScreen.tsx","App.tsx","serviceWorker.js","index.js"],"names":["GameStateType","MessageType","KEEP_ALIVE","ms","NodeMessage","_ref","channel","type","clientId","Object","classCallCheck","this","unknown","JSON","stringify","toObject","GameContextMessage","context","_this","possibleConstructorReturn","getPrototypeOf","call","gameStateChange","state","ready","clients","currentClientId","thinkTimeOut","delayTimeOut","org","get","prototype","objectSpread","TurnToMessage","_this2","turnTo","turnToClientId","GameStateManager","_ref2","getMeta","Error","clientName","_","find","client","id","push","name","foundClient","pull","toString","end","pause","play","_ref3","length","index","map","indexOf","clientLength","nextClientId","e","console","error","MessageFactory","_ref4","MessageDispatcher","_ref5","topic","data","message","object","parse","emit","EventEmitter","WebSocketProxy","props","_this3","undefined","gameStateManager","messageFactory","messageDispatcher","connected","onChangeConnected","_this4","close","dispatcher","mqtt","connect","keepalive","on","subscribe","err","onConnected","next","newState","loadCurrentState","log","getHost","concat","join","onChangeThinkTimeOut","onChangeDelayTimeOut","onChangeClients","onChangeGameState","onTurnTo","msg","onTurnYou","joinClient","publish","qos","retain","exitClient","changeToPlay","info","getTurnInfo","getStateMessage","changeToPause","changeToEnd","_ref6","changeTimeout","changeToReady","react_default","a","createElement","className","children","Component","Transition","Slide_default","assign","direction","AlertDialogSlide","handleSave","onSave","handleClose","onClose","Dialog_default","open","TransitionComponent","keepMounted","aria-labelledby","aria-describedby","DialogTitle_default","DialogContent_default","DialogActions_default","Button_default","onClick","color","React","FullScreenDialog","_this$props","classes","_this$props$title","title","fullScreen","AppBar_default","appBar","Toolbar_default","IconButton_default","aria-label","Close_default","Typography_default","variant","flex","withStyles","position","__convertVisibleMS","value","contentString","swalOptions","content","element","attributes","swal","__showSnackbar","stack","_saveClientFromStorage","sessionStorage","setItem","_loadClientFromStorage","getItem","defaultId","Math","random","substr","__replaceSpeechText","text","replaceObject","result","String","forEach","key","replace","App","gameState","settingDialog","turnTimeoutDialog","turnMeSpeechText","timeoutSpeechText","wsProxy","createRef","audioComponent","handelChangeClient","bind","assertThisInitialized","renderClients","handelTurnTo","handleTurnYou","handleCloseTurnTimeoutDialog","setState","speechText","current","q","encodeURIComponent","src","setAttribute","load","timeout","arguments","turnMeText","playTTS","setTimeout","handleOpenTurnTimeoutDialog","Items","ListItem_default","dense","ListItemText_default","primary","classname","App-highlight","ListItemSecondaryAction_default","exit","Delete_default","List_default","renderGameState","grow","Settings_default","Grid_default","container","spacing","item","xs","ExpansionPanel_default","ExpansionPanelSummary_default","expandIcon","ExpandMore_default","heading","Wifi_default","WifiOff_default","ExpansionPanelDetails_default","TextField_default","fullWidth","label","defaultValue","textField","margin","onChange","event","target","button","src_WebSocketProxy","ref","SettingDialog","helperText","TimeoutFullScreen","bigButton","theme","root","flexGrow","fontSize","typography","pxToRem","fontWeight","fontWeightRegular","marginLeft","unit","marginRight","width","height","Boolean","window","location","hostname","match","ReactDOM","render","src_App_0","document","getElementById","navigator","serviceWorker","then","registration","unregister"],"mappings":"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","file":"static/js/main.3ca11abb.chunk.js","sourcesContent":["import mqtt from 'mqtt';\nimport React, { Component } from 'react';\nimport {object} from \"prop-types\";\nimport EventEmitter from 'eventemitter3'\nimport _ from 'lodash';\nimport ms from 'ms';\n\nconst KEEP_ALIVE = ms('5h') / 1000; // sec\n\nexport enum GameStateType {\n    ready = 'GameStateTypeReady',\n    play = 'GameStateTypePlay',\n    pause = 'GameStateTypePause',\n    end = 'GameStateTypeEnd',\n}\n\nexport enum MessageType {\n    unknown = 'unknown',\n    turnTo = 'turnTo',\n    gameStateChange = 'gameStateChange',\n}\n\nexport interface MqttClientMeta {\n    id: string,\n    name: string,\n}\n\ninterface TurnInfo {\n    currentClientId: string,\n    nextClientId: string,\n}\n\ninterface MessageMeta {\n    clientId: string,\n    channel: string,\n}\n\nclass NodeMessage {\n    channel = '';\n    type?: MessageType = MessageType.unknown;\n    readonly clientId: string;\n    constructor({channel, type, clientId}: {channel: string, type?: MessageType, clientId: string}) {\n        this.channel = channel;\n        this.clientId = clientId;\n        if(this.type) {\n            this.type = type;\n        }\n    }\n    toObject() : object {\n        return {\n            type: this.type,\n            channel: this.channel,\n            clientId: this.clientId,\n        };\n    }\n    toString() : string {\n        return JSON.stringify(this.toObject());\n    }\n}\n\nclass GameContextMessage extends NodeMessage {\n    type = MessageType.gameStateChange;\n    state = GameStateType.ready;\n    clients: Array<MqttClientMeta> = [];\n    currentClientId: string = '';\n    thinkTimeOut: number = ms('5s');\n    delayTimeOut: number = ms('2s');\n\n    constructor(context: any) {\n        super(context);\n        if(context && context.state) {\n            this.state = context.state;\n        }\n\n        if(context && context.clients) {\n            this.clients = context.clients;\n        }\n\n        if(context && context.currentClientId) {\n            this.currentClientId = context.currentClientId;\n        }\n\n        if(context && context.thinkTimeOut) {\n            this.thinkTimeOut = context.thinkTimeOut;\n        }\n\n        if(context && context.delayTimeOut) {\n            this.delayTimeOut = context.delayTimeOut;\n        }\n    }\n    toObject() {\n        const org = super.toObject();\n        return {\n            ...org,\n            state: this.state,\n            clients: this.clients,\n            currentClientId: this.currentClientId,\n            thinkTimeOut: this.thinkTimeOut,\n            delayTimeOut: this.delayTimeOut,\n        };\n    }\n    getHost() {\n        return this.clientId;\n    }\n}\n\nclass TurnToMessage extends NodeMessage {\n    type = MessageType.turnTo;\n    turnToClientId: string = '';\n    constructor(context: any) {\n        super(context);\n        if(context.turnToClientId) {\n            this.turnToClientId = context.turnToClientId;\n        }\n    }\n    toObject() {\n        const org = super.toObject();\n        return {...org, turnToClientId: this.turnToClientId};\n    }\n}\n\nclass GameStateManager {\n    channel = '';\n    clientId = '';\n    context: GameContextMessage = new GameContextMessage(this.getMeta());\n\n    constructor({channel, clientId} : MessageMeta) {\n        this.channel = channel;\n        this.clientId = clientId;\n\n        this.context =  new GameContextMessage(this.getMeta());\n    }\n\n    private getMeta(): MessageMeta {\n        return {\n            channel: this.channel,\n            clientId: this.clientId,\n        };\n    }\n\n    loadCurrentState(state: GameContextMessage) {\n        if(!(state instanceof GameContextMessage)) {\n            throw new Error('can not load current state');\n        }\n        this.context = state;\n        return this.context;\n    }\n    joinClient(clientId: string, clientName: string) {\n        const foundClient = _.find<MqttClientMeta>(this.context.clients, (client) => client.id === clientId);\n        if(!foundClient) {\n            this.context.clients.push({\n                id: clientId,\n                name: clientName,\n            });\n        }\n        return this.context;\n    }\n    exitClient(clientId: string) {\n        const foundClient = _.find<MqttClientMeta>(this.context.clients, (client) => client.id === clientId);\n        if(foundClient) {\n            _.pull(this.context.clients, foundClient);\n        }\n        return this.context;\n    }\n\n    getStateMessage(): string {\n        return this.context.toString();\n    }\n    changeToReady() {\n        this.context.state = GameStateType.ready;\n        return this.context;\n    }\n    changeToEnd() {\n        this.context.state = GameStateType.end;\n        return this.context;\n    }\n    changeToPause() {\n        this.context.state = GameStateType.pause;\n        return this.context;\n    }\n    changeToPlay() {\n        this.context.state = GameStateType.play;\n        return this.context;\n    }\n    changeTimeout({thinkTimeOut, delayTimeOut} : {thinkTimeOut: number, delayTimeOut: number}) {\n        this.context.thinkTimeOut = thinkTimeOut;\n        this.context.delayTimeOut = delayTimeOut;\n        return this.context;\n    }\n    getTurnInfo(): TurnInfo | undefined {\n        if(this.context.clients.length === 0) {\n            const e =  new Error('At least one client');\n            console.error(e);\n            return;\n        }\n\n        const currentClientId = this.context.currentClientId;\n\n        let index = this.context.clients.map(client => client.id).indexOf(currentClientId);\n        index = (index === -1) ? 0 : index;\n\n        const clientLength = this.context.clients.length;\n\n        return {\n            currentClientId: this.context.clients[index].id,\n            nextClientId: this.context.clients[(index + 1) % clientLength].id,\n        }\n    }\n}\n\nclass MessageFactory {\n    channel = '';\n    clientId = '';\n    constructor({channel, clientId} : MessageMeta) {\n        this.channel = channel;\n        this.clientId = clientId;\n    }\n\n    private getMeta(): MessageMeta {\n        return {\n            channel: this.channel,\n            clientId: this.clientId,\n        };\n    }\n    turnTo(clientId: string): string {\n        const msg = new TurnToMessage({...this.getMeta(), turnToClientId: clientId});\n        return msg.toString();\n    }\n}\n\nclass MessageDispatcher extends EventEmitter {\n    next({topic, message}: {topic: string, message: any}) {\n        let data;\n        if( message instanceof object) {\n            data = message\n        } else {\n            data = JSON.parse(message.toString());\n        }\n\n        if(!data.type) {\n            this.emit('error', new Error('can not find message type'));\n            return;\n        }\n\n        const type = data.type;\n        this.emit('message', data);\n        this.emit(type, data);\n    }\n}\n\ninterface IWebSocketProxyProps {\n    onChangeClients?: (clients: Array<MqttClientMeta>) => void,\n    onChangeGameState?: (clients: GameStateType) => void,\n    onChangeThinkTimeOut?: (timeout: number) => void,\n    onChangeDelayTimeOut?: (timeout: number) => void,\n    onTurnYou?: () => void,\n    onTurnTo?: (clientId: string) => void,\n    onConnected?: (mqttClient: mqtt.MqttClient) => void,\n    onChangeConnected?: (connected: boolean) => void,\n    clientId: string,\n}\n\ninterface IWebSocketProxyState {\n}\n\nclass WebSocketProxy extends Component<IWebSocketProxyProps, IWebSocketProxyState> {\n    client?: mqtt.MqttClient = undefined;\n    gameStateManager?: GameStateManager = undefined;\n    messageFactory?: MessageFactory = undefined;\n    messageDispatcher?: MessageDispatcher = undefined;\n    channel: string = 'testchannel';\n\n    constructor(props: any) {\n        super(props);\n    }\n\n    close() {\n        if(this.client) {\n            if(this.client.connected) {\n                this.client.end();\n            }\n            if(this.props.onChangeConnected) {\n                this.props.onChangeConnected(false);\n            }\n        }\n        this.client = undefined;\n    }\n\n    open(channel: string) {\n        this.close();\n\n        this.channel = channel;\n\n        const clientId = this.props.clientId;\n\n        const gameStateManager = new GameStateManager({channel, clientId});\n        const messageFactory = new MessageFactory({channel, clientId});\n        const dispatcher = new MessageDispatcher();\n\n        // Mqtt connection\n        const client = mqtt.connect('wss://aud.ssp.hinet.net:443/mqtt', {keepalive: KEEP_ALIVE, clientId});\n        client.on('connect',  () => {\n            client.subscribe(channel, (err) => {\n                if (err) {\n                    console.error(err);\n                }\n            });\n            if(this.props.onConnected) {\n                this.props.onConnected(client);\n            }\n            if(this.props.onChangeConnected) {\n                this.props.onChangeConnected(client.connected);\n            }\n        });\n        client.on('message', function (topic, message) {\n            dispatcher.next({topic, message});\n            // console.log(`topic = ${topic}, message = ${message}`)\n        });\n\n\n        // Event handler\n        dispatcher.on(MessageType.gameStateChange, (data) => {\n            // init game state\n            const newState = new GameContextMessage(data);\n\n            gameStateManager.loadCurrentState(newState);\n            console.log('==============================');\n            console.log('Channel by : ' + gameStateManager.context.channel);\n            console.log('thinkTimeOut : ' + ms(gameStateManager.context.thinkTimeOut));\n            console.log('delayTimeOut : ' + ms(gameStateManager.context.delayTimeOut));\n            console.log('Host by : ' + gameStateManager.context.getHost());\n            console.log('Game state : ' + gameStateManager.context.state);\n            console.log('Current : ' + gameStateManager.context.currentClientId);\n            console.log('Clients : \\n' + gameStateManager.context.clients.map(client => `${client.id} - ${client.name}`).join('\\n'));\n            console.log('==============================');\n\n            if(this.props.onChangeThinkTimeOut) {\n                this.props.onChangeThinkTimeOut(gameStateManager.context.thinkTimeOut);\n            }\n            if(this.props.onChangeDelayTimeOut) {\n                this.props.onChangeDelayTimeOut(gameStateManager.context.delayTimeOut);\n            }\n            if(this.props.onChangeClients) {\n                this.props.onChangeClients(gameStateManager.context.clients);\n            }\n            if(this.props.onChangeGameState) {\n                this.props.onChangeGameState(gameStateManager.context.state);\n            }\n            if(this.props.onTurnTo) {\n                this.props.onTurnTo(gameStateManager.context.currentClientId);\n            }\n\n            // dispatch game state\n            if(gameStateManager.context.state === GameStateType.play) {\n                dispatcher.emit(GameStateType.play);\n            }\n            if(gameStateManager.context.state === GameStateType.ready) {\n                dispatcher.emit(GameStateType.ready);\n            }\n            if(gameStateManager.context.state === GameStateType.pause) {\n                dispatcher.emit(GameStateType.pause);\n            }\n            if(gameStateManager.context.state === GameStateType.end) {\n                dispatcher.emit(GameStateType.end);\n            }\n        });\n\n        dispatcher.on(MessageType.turnTo, (data) => {\n            const msg = new TurnToMessage(data);\n            if(this.props.onTurnTo) {\n                this.props.onTurnTo(msg.turnToClientId);\n            }\n\n            if(this.props.clientId === msg.turnToClientId) {\n                // console.log('turn to ==> ' + this.props.clientId);\n                if(this.props.onTurnYou) {\n                    this.props.onTurnYou();\n                }\n            }\n        });\n\n        // helper\n        this.client = client;\n        this.gameStateManager = gameStateManager;\n        this.messageFactory = messageFactory;\n        this.messageDispatcher = dispatcher;\n    }\n\n    join(clientId: string, clientName: string) {\n        if(this.gameStateManager && this.gameStateManager.context.state !== GameStateType.ready) {\n            console.error(new Error('Only join client for \"ready\" state'));\n            return;\n        }\n\n        if(this.client && this.gameStateManager) {\n            const state = this.gameStateManager.joinClient(clientId, clientName);\n            this.client.publish(this.channel, state.toString(), {qos:2, retain: true});\n        }\n    }\n\n    exit(clientId: string) {\n        if(this.client && this.gameStateManager) {\n            const state = this.gameStateManager.exitClient(clientId);\n            this.client.publish(this.channel, state.toString(), {qos:2, retain: true});\n        }\n    }\n\n    play() {\n        if(this.client && this.gameStateManager && this.messageFactory) {\n            const context = this.gameStateManager.changeToPlay();\n            this.client.publish(this.channel, this.messageFactory.turnTo(context.currentClientId), {qos:2});\n            this.client.publish(this.channel, context.toString(), {qos:2, retain: true})\n        }\n    }\n\n    next() {\n        if(this.client && this.gameStateManager) {\n            const context = this.gameStateManager.context;\n            const info = this.gameStateManager.getTurnInfo();\n\n\n            if(this.messageFactory && info && context.currentClientId === '') { // First\n                context.currentClientId = info ? info.currentClientId : '';\n                this.client.publish(this.channel, this.messageFactory.turnTo(context.currentClientId), {qos:2});\n            }else if(this.messageFactory && info &&  context.currentClientId !== info.nextClientId) { // in playing\n                context.currentClientId = info ? info.nextClientId : '';\n                this.client.publish(this.channel, this.messageFactory.turnTo(context.currentClientId), {qos:2});\n            }\n\n            // Change game context\n            this.client.publish(this.channel, this.gameStateManager.getStateMessage(), {qos:2, retain: true});\n        }\n    }\n\n    pause() {\n        if(this.client && this.gameStateManager) {\n            this.gameStateManager.changeToPause();\n            this.client.publish(this.channel, this.gameStateManager.getStateMessage(), {qos:2, retain: true})\n        }\n    }\n\n    end() {\n        if(this.client && this.gameStateManager) {\n            const context = this.gameStateManager.changeToEnd();\n            context.currentClientId = '';\n            this.client.publish(this.channel, this.gameStateManager.getStateMessage(), {qos:2, retain: true})\n        }\n    }\n\n    changeTimeout({thinkTimeOut, delayTimeOut} : {thinkTimeOut: number, delayTimeOut: number}) {\n        if(this.client && this.gameStateManager) {\n            const context = this.gameStateManager.changeTimeout({thinkTimeOut, delayTimeOut});\n            this.client.publish(this.channel, context.toString(), {qos:2, retain: true})\n        }\n    }\n\n    ready() {\n        if(this.client && this.gameStateManager) {\n            const context = this.gameStateManager.changeToReady();\n            context.currentClientId = '';\n            this.client.publish(this.channel, this.gameStateManager.getStateMessage(), {qos:2, retain: true})\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"websocket-proxy\">\n                {this.props.children}\n            </div>\n        );\n    }\n}\n\nexport default WebSocketProxy;\n","import React from 'react';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Slide from '@material-ui/core/Slide';\n\nfunction Transition(props: any) {\n    return <Slide direction=\"up\" {...props} />;\n}\n\n\ninterface IAlertDialogSlide {\n    // classes: any,\n    open: boolean,\n    onClose?: () => void,\n    onSave?: () => void,\n}\n\n\nclass AlertDialogSlide extends React.Component<IAlertDialogSlide> {\n    handleSave = () => {\n        if(this.props.onSave) {\n            this.props.onSave();\n            this.handleClose();\n        }\n    };\n    handleClose = () => {\n        if(this.props.onClose) {\n            this.props.onClose();\n        }\n    };\n\n    render() {\n        return (\n            <div>\n                <Dialog\n                    open={this.props.open}\n                    TransitionComponent={Transition}\n                    keepMounted\n                    onClose={this.handleClose}\n                    aria-labelledby=\"alert-dialog-slide-title\"\n                    aria-describedby=\"alert-dialog-slide-description\"\n                >\n                    <DialogTitle id=\"alert-dialog-slide-title\">\n                        {\"設定\"}\n                    </DialogTitle>\n                    <DialogContent>\n                        {this.props.children}\n                    </DialogContent>\n                    <DialogActions>\n                        <Button onClick={this.handleClose} color=\"primary\">\n                            取消\n                        </Button>\n                        <Button onClick={this.handleSave} color=\"primary\">\n                            儲存\n                        </Button>\n                    </DialogActions>\n                </Dialog>\n            </div>\n        );\n    }\n}\n\nexport default AlertDialogSlide;\n","import React from 'react';\nimport { withStyles } from '@material-ui/core/styles';\nimport Dialog from '@material-ui/core/Dialog';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport IconButton from '@material-ui/core/IconButton';\nimport Typography from '@material-ui/core/Typography';\nimport CloseIcon from '@material-ui/icons/Close';\nimport Slide from '@material-ui/core/Slide';\n\nconst styles: any = {\n    appBar: {\n        position: 'relative',\n    },\n    flex: {\n        flex: 1,\n    },\n};\n\nfunction Transition(props: any) {\n    return <Slide direction=\"up\" {...props} />;\n}\n\ninterface IFullScreenDialogProps {\n    classes: any,\n    open: boolean,\n    title?: string\n    onClose?: () => void,\n}\n\nclass FullScreenDialog extends React.Component<IFullScreenDialogProps> {\n    handleClose = () => {\n        if(this.props.onClose) {\n            this.props.onClose();\n        }\n    };\n\n    render() {\n        const { classes, title = '' } = this.props;\n        return (\n            <div>\n                <Dialog\n                    fullScreen\n                    open={this.props.open}\n                    onClose={this.handleClose}\n                    TransitionComponent={Transition}\n                >\n                    <AppBar className={classes.appBar}>\n                        <Toolbar>\n                            <IconButton color=\"inherit\" onClick={this.handleClose} aria-label=\"Close\">\n                                <CloseIcon />\n                            </IconButton>\n                            <Typography variant=\"h6\" color=\"inherit\" className={classes.flex}>\n                                {title}\n                            </Typography>\n                        </Toolbar>\n                    </AppBar>\n                    {this.props.children}\n                </Dialog>\n            </div>\n        );\n    }\n}\n\nexport default withStyles(styles)(FullScreenDialog);\n","import React, {Component} from 'react';\nimport classname from 'classnames';\nimport _ from 'lodash';\nimport { withStyles } from '@material-ui/core/styles';\nimport ms from 'ms';\nimport swal from 'sweetalert';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport IconButton from '@material-ui/core/IconButton';\nimport Typography from '@material-ui/core/Typography';\nimport NetworkOnIcon from '@material-ui/icons/Wifi';\nimport NetworkOffIcon from '@material-ui/icons/WifiOff';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport TextField from '@material-ui/core/TextField';\nimport ExpansionPanel from '@material-ui/core/ExpansionPanel';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport DeleteIcon from '@material-ui/icons/Delete';\n\nimport './App.css';\nimport WebSocketProxy, {GameStateType, MqttClientMeta} from './WebSocketProxy';\nimport SettingDialog from './SettingDialog';\nimport TimeoutFullScreen from './TimeoutFullScreen';\n\nfunction __showSnackbar(title: string, contentString: string) {\n    const contentOptions = {\n        element: 'textarea',\n        attributes: {\n            value: contentString,\n        },\n    };\n    const swalOptions = {\n        title,\n        // icon: 'info',\n        content: contentOptions,\n        // buttons: [],\n        // timer: 3000,\n    };\n    swal(swalOptions);\n}\n\nfunction __convertVisibleMS(value: any) {\n    try {\n        return ms(value);\n    } catch (e) {\n        console.error(e);\n        __showSnackbar(e.message, e.stack);\n    }\n    return '';\n}\n\nfunction _saveClientFromStorage(client: MqttClientMeta) {\n    sessionStorage.setItem('clientId', client.id);\n    sessionStorage.setItem('clientName', client.name);\n}\n\nfunction _loadClientFromStorage(): MqttClientMeta {\n    const clientId = sessionStorage.getItem('clientId');\n    const clientName = sessionStorage.getItem('clientName');\n    const defaultId = 'you-turn_' + Math.random().toString(16).substr(2, 8);\n    const client =  {\n        id: clientId || defaultId,\n        name: clientName || defaultId,\n    };\n    _saveClientFromStorage(client);\n    return client;\n}\n\nconst styles = (theme: any) => ({\n    root: {\n        flexGrow: 1,\n    },\n    grow: {\n        flexGrow: 1,\n    },\n    heading: {\n        fontSize: theme.typography.pxToRem(15),\n        fontWeight: theme.typography.fontWeightRegular,\n    },\n    textField: {\n        marginLeft: theme.spacing.unit,\n        marginRight: theme.spacing.unit,\n    },\n    button: {\n        margin: theme.spacing.unit,\n    },\n    bigButton: {\n        margin: theme.spacing.unit,\n        width: \"100%\",\n        height: \"45%\",\n    }\n});\n\nfunction __replaceSpeechText(text: string, replaceObject: {name: string}) {\n    let result = String(text);\n    _.forEach(replaceObject, (value, key) => {\n        result = result.replace('${' + key + '}', value);\n    });\n    console.log(result);\n    return result;\n}\n\ninterface IAppProps {\n    classes: any,\n}\n\ninterface IAppState {\n    clients: Array<MqttClientMeta>,\n    clientName: string,\n    clientId: string,\n    channel: string,\n    gameState: GameStateType,\n    currentClientId: string,\n    connected: boolean,\n    thinkTimeOut: number,\n    delayTimeOut: number,\n    settingDialog: boolean,\n    turnTimeoutDialog: boolean,\n    turnMeSpeechText: string,\n    timeoutSpeechText: string,\n}\n\nclass App extends Component<IAppProps, IAppState> {\n    wsProxy: React.RefObject<WebSocketProxy>;\n    audioComponent: React.RefObject<HTMLAudioElement>;\n    state = {\n        clients: [],\n        clientId: _loadClientFromStorage().id,\n        clientName: _loadClientFromStorage().name,\n        channel: 'testchannel',\n        gameState: GameStateType.end,\n        currentClientId: '',\n        connected: false,\n        thinkTimeOut: 0,\n        delayTimeOut: 0,\n        settingDialog: false,\n        turnTimeoutDialog: false,\n        turnMeSpeechText: '${name} 換你了',\n        timeoutSpeechText: '${name} 時間到了',\n    };\n\n    constructor(props: any) {\n        super(props);\n        this.wsProxy = React.createRef();\n        this.audioComponent = React.createRef();\n        this.handelChangeClient = this.handelChangeClient.bind(this);\n        this.renderClients = this.renderClients.bind(this);\n        this.handelTurnTo = this.handelTurnTo.bind(this);\n        this.handleTurnYou = this.handleTurnYou.bind(this);\n        this.handleCloseTurnTimeoutDialog = this.handleCloseTurnTimeoutDialog.bind(this);\n    }\n\n    componentDidMount() {\n        // if(this.wsProxy.current) {\n        //     this.wsProxy.current.open(this.state.channel);\n        // }\n    }\n\n    handelChangeClient(clients: Array<MqttClientMeta>) {\n        this.setState(() => ({clients}));\n    }\n\n    handelTurnTo(clientId: string) {\n        this.setState(() => ({currentClientId: clientId}));\n    }\n\n    handleCloseTurnTimeoutDialog() {\n        this.setState(() => ({turnTimeoutDialog: false}));\n    }\n    handleOpenTurnTimeoutDialog() {\n        this.setState(() => ({turnTimeoutDialog: true}));\n    }\n\n    playTTS(speechText: string) {\n        //\n        if(this.audioComponent.current) {\n            const q = encodeURIComponent(speechText);\n            // const src = 'http://translate.google.com/translate_tts?ie=UTF-8&total=1&idx=0&textlen=32&client=tw-ob&tl=en-gb&q=' + q;\n            // const src = 'http://translate.google.com/translate_tts?ie=UTF-8&total=1&idx=0&client=tw-ob&tl=zh-tw&q=' + q;\n            const src = `https://google-translate-proxy.herokuapp.com/api/tts?query=${q}&language=zh-TW&speed=0.5`;\n            this.audioComponent.current.setAttribute('src',  src);\n            this.audioComponent.current.load();\n            this.audioComponent.current.play();\n        }\n    }\n\n    handleTurnYou(timeout = this.state.thinkTimeOut) {\n        if(this.state.gameState !== GameStateType.play) {\n            return;\n        }\n\n        const clientName = this.state.clientName;\n\n        // Show: turn me\n        console.log('Turn me: ' + clientName);\n        const turnMeText = __replaceSpeechText(this.state.turnMeSpeechText,{name: clientName});\n        this.playTTS(turnMeText);\n\n        // Show: timeout\n        const timer = setTimeout(() => {\n            const speechText = __replaceSpeechText(this.state.timeoutSpeechText,{name: clientName});\n            this.playTTS(speechText);\n\n            this.handleOpenTurnTimeoutDialog();\n\n            // // dialog\n            // swal(speechText, {\n            //     buttons: {\n            //         delay: {\n            //             text: \"再一下\",\n            //             value: \"delay\",\n            //         },\n            //         next: {\n            //             text: \"下一位\",\n            //             value: \"next\",\n            //         },\n            //     },\n            // })\n            //     .then((value) => {\n            //         switch (value) {\n            //             case \"next\": {\n            //                 if(this.wsProxy.current) {\n            //                     this.wsProxy.current.next();\n            //                 }\n            //                 break;\n            //             }\n            //             case \"delay\": {\n            //                 this.handleTurnYou(this.state.delayTimeOut);\n            //                 break;\n            //             }\n            //         }\n            //     });\n        }, timeout);\n    }\n\n    renderClients(clients: Array<MqttClientMeta>) {\n        const Items: any[] = [];\n        clients.forEach(client => {\n            Items.push((\n                <ListItem key={client.id} dense>\n                    <ListItemText primary={<span className={classname({'App-highlight': (client.id === this.state.currentClientId)})}>{client.name} ({client.id})</span>} />\n                    <ListItemSecondaryAction>\n                        <IconButton onClick={() => {\n                            this.wsProxy.current && this.wsProxy.current.exit(client.id);\n                        }}>\n                            <DeleteIcon />\n                        </IconButton>\n                    </ListItemSecondaryAction>\n                </ListItem>));\n        });\n\n        return (\n            <List>\n                {Items}\n            </List>\n        );\n    }\n\n    renderGameState(state: GameStateType) {\n        if(state === GameStateType.play) {\n            return \"Play\";\n        }\n        if(state === GameStateType.ready) {\n            return \"Ready\";\n        }\n        if(state === GameStateType.end) {\n            return \"End\";\n        }\n        if(state === GameStateType.pause) {\n            return \"Pause\";\n        }\n        return \"End\";\n    }\n\n    render() {\n        const {classes} = this.props;\n        return (\n            <div className=\"App\">\n                <AppBar position=\"static\">\n                    <Toolbar>\n                        {this.renderGameState(this.state.gameState)}\n                        <Typography variant=\"title\" color=\"inherit\" className={classes.grow}>\n                            {this.state.clientName}\n                        </Typography>\n                        <Typography variant=\"caption\" color=\"inherit\" className={classes.grow}>\n                            {this.state.clientId}\n                        </Typography>\n                        {this.state.connected && <IconButton color=\"inherit\" onClick={()=>{\n                            this.setState(() => ({settingDialog: true}));\n                        }}><SettingsIcon/></IconButton>}\n                    </Toolbar>\n                </AppBar>\n                <Grid container spacing={16}>\n                    <Grid item xs={12}>\n                        <ExpansionPanel>\n                            <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                                <Typography className={classes.heading}>\n                                    {this.state.connected ? <NetworkOnIcon/> : <NetworkOffIcon/>}\n                                    連線\n                                </Typography>\n                            </ExpansionPanelSummary>\n                            <ExpansionPanelDetails>\n                                <Grid container spacing={16}>\n                                    <Grid item xs={12}>\n                                        <TextField\n                                            id=\"network-channel\"\n                                            fullWidth\n                                            label=\"Channel\"\n                                            value={this.state.channel}\n                                            defaultValue={this.state.channel}\n                                            className={classes.textField}\n                                            margin=\"normal\"\n                                            onChange={event => {\n                                                const value = event.target.value;\n                                                this.setState(() => ({channel: value}));\n                                            }}\n                                        />\n                                        <Button variant=\"contained\" color=\"primary\" className={classes.button} onClick={() => {\n                                            if(this.wsProxy.current) {\n                                                this.wsProxy.current.open(this.state.channel);\n                                            }\n                                        }}>\n                                            Open\n                                        </Button>\n                                        <Button variant=\"contained\" className={classes.button} onClick={() => {\n                                            if(this.wsProxy.current) {\n                                                this.wsProxy.current.exit(this.state.clientId);\n                                                this.wsProxy.current.close();\n                                            }\n                                        }}>\n                                            Close\n                                        </Button>\n                                    </Grid>\n                                    <Grid item xs={12}>\n                                        <TextField\n                                            id=\"game-name\"\n                                            fullWidth\n                                            label=\"名稱\"\n                                            value={this.state.clientName}\n                                            defaultValue={this.state.clientName}\n                                            className={classes.textField}\n                                            margin=\"normal\"\n                                            onChange={event => {\n                                                const value = event.target.value;\n                                                this.setState(() => ({clientName: value}));\n                                            }}\n                                        />\n                                        <Button variant=\"contained\" color=\"primary\" className={classes.button} onClick={() => {\n                                            if(this.wsProxy.current) {\n                                                _saveClientFromStorage({id: this.state.clientId, name: this.state.clientName});\n                                                this.wsProxy.current.join(this.state.clientId, this.state.clientName);\n                                            }\n                                        }}>\n                                            加入\n                                        </Button>\n                                    </Grid>\n                                </Grid>\n                            </ExpansionPanelDetails>\n                        </ExpansionPanel>\n                    </Grid>\n                    <Grid item xs={12}>\n                        <Button className={classes.button} onClick={() => {\n                            if(this.wsProxy.current) {\n                                this.wsProxy.current.ready();\n                            }\n                        }}>Ready</Button>\n                        <Button className={classes.button} onClick={() => {\n                            if(this.wsProxy.current) {\n                                this.wsProxy.current.end();\n                            }\n                        }}>End</Button>\n                        <Button className={classes.button} onClick={() => {\n                            if(this.wsProxy.current) {\n                                this.wsProxy.current.play();\n                            }\n                        }}>Play</Button>\n                        <Button className={classes.button} onClick={() => {\n                            if(this.wsProxy.current) {\n                                this.wsProxy.current.pause();\n                            }\n                        }}>Pause</Button>\n                        <Button className={classes.button} onClick={() => {\n                            if(this.wsProxy.current) {\n                                this.wsProxy.current.next();\n                            }\n                        }}>Next</Button>\n                    </Grid>\n                    <Grid item xs={12}>\n                        {this.renderClients(this.state.clients)}\n                    </Grid>\n                </Grid>\n                <WebSocketProxy\n                    clientId={this.state.clientId}\n                    ref={this.wsProxy}\n                    onTurnTo={this.handelTurnTo}\n                    onChangeClients={this.handelChangeClient}\n                    onChangeGameState={state => {\n                        this.setState(() => ({gameState: state}));\n                    }}\n                    onTurnYou={this.handleTurnYou}\n                    onChangeConnected={connected => {\n                        this.setState(() => ({connected}));\n                    }}\n                    onChangeThinkTimeOut={timeout => {\n                        this.setState(() => ({thinkTimeOut: timeout}));\n                    }}\n                    onChangeDelayTimeOut={timeout => {\n                        this.setState(() => ({delayTimeOut: timeout}));\n                    }} />\n                <audio id=\"player\" src=\"#\" ref={this.audioComponent}/>\n                <SettingDialog open={this.state.settingDialog} onClose={() => {\n                    this.setState(() => ({settingDialog: false}))\n                }} onSave={() => {\n                    if(this.wsProxy.current) {\n                        this.wsProxy.current.changeTimeout({\n                            thinkTimeOut: this.state.thinkTimeOut,\n                            delayTimeOut: this.state.delayTimeOut,\n                        });\n                    }\n                }}>\n                    <TextField\n                        id=\"setting-think-timeout\"\n                        fullWidth\n                        label=\"思考時間\"\n                        value={this.state.thinkTimeOut}\n                        defaultValue={this.state.thinkTimeOut}\n                        className={classes.textField}\n                        helperText={__convertVisibleMS(this.state.thinkTimeOut)}\n                        margin=\"normal\"\n                        onChange={event => {\n                            const value = event.target.value;\n                            this.setState(() => ({thinkTimeOut: +value}));\n                        }}\n                    />\n                    <TextField\n                        id=\"setting-delay-timeout\"\n                        fullWidth\n                        label=\"延時時間\"\n                        value={this.state.delayTimeOut}\n                        defaultValue={this.state.delayTimeOut}\n                        className={classes.textField}\n                        helperText={__convertVisibleMS(this.state.delayTimeOut)}\n                        margin=\"normal\"\n                        onChange={event => {\n                            const value = event.target.value;\n                            this.setState(() => ({delayTimeOut: +value}));\n                        }}\n                    />\n                    <TextField\n                        fullWidth\n                        label=\"「換你」語音樣版\"\n                        value={this.state.turnMeSpeechText}\n                        defaultValue={this.state.turnMeSpeechText}\n                        className={classes.textField}\n                        helperText={'${name}: 名稱'}\n                        margin=\"normal\"\n                        onChange={event => {\n                            const value = event.target.value;\n                            this.setState(() => ({turnMeSpeechText: value}));\n                        }}\n                    />\n                    <TextField\n                        fullWidth\n                        label=\"「到時」語音樣版\"\n                        value={this.state.timeoutSpeechText}\n                        defaultValue={this.state.timeoutSpeechText}\n                        className={classes.textField}\n                        helperText={'${name}: 名稱'}\n                        margin=\"normal\"\n                        onChange={event => {\n                            const value = event.target.value;\n                            this.setState(() => ({timeoutSpeechText: value}));\n                        }}\n                    />\n                </SettingDialog>\n                <TimeoutFullScreen title={'時間到了'} open={this.state.turnTimeoutDialog} onClose={this.handleCloseTurnTimeoutDialog}>\n                    <Button className={classes.bigButton} variant=\"contained\" onClick={() => {\n                        this.handleTurnYou(this.state.delayTimeOut);\n                        this.handleCloseTurnTimeoutDialog();\n                    }}>\n                        再一下\n                    </Button>\n                    <Button className={classes.bigButton} variant=\"contained\" color=\"primary\" onClick={() => {\n                        if(this.wsProxy.current) {\n                            this.wsProxy.current.next();\n                        }\n                        this.handleCloseTurnTimeoutDialog();\n                    }}>\n                        下一位\n                    </Button>\n                </TimeoutFullScreen>\n            </div>\n        );\n    }\n}\n\nexport default withStyles(styles)(App);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}