{"version":3,"sources":["WebSocketProxy.tsx","SettingDialog.tsx","TimeoutFullScreen.tsx","App.tsx","serviceWorker.js","index.js"],"names":["GameStateType","MessageType","DEFAULT_EPIC","KEEP_ALIVE","ms","NodeMessage","_ref","channel","type","clientId","Object","classCallCheck","this","unknown","JSON","stringify","toObject","GameContextMessage","context","_this","possibleConstructorReturn","getPrototypeOf","call","gameStateChange","state","ready","clients","currentClientId","thinkTimeOut","delayTimeOut","epic","_","isNumber","org","get","prototype","objectSpread","TurnToMessage","_this2","turnTo","turnToClientId","GameStateManager","_ref2","getMeta","Error","clientName","find","client","id","push","name","order","length","enable","foundClient","pull","toString","end","pause","play","_ref3","_this3","candidateClients","filter","index","map","indexOf","clientLength","nextClientId","delta","sort","a","b","console","log","concat","MessageFactory","_ref4","MessageDispatcher","_ref5","topic","data","message","object","parse","emit","EventEmitter","WebSocketProxy","props","_this4","undefined","gameStateManager","messageFactory","messageDispatcher","connected","onChangeConnected","_this5","close","dispatcher","mqtt","connect","keepalive","on","subscribe","err","error","onConnected","next","newState","loadCurrentState","getHost","join","onChangeThinkTimeOut","onChangeDelayTimeOut","onChangeClients","onChangeGameState","onTurnTo","onChangeEpic","msg","onTurnYou","onNotTurnYou","onError","joinClient","publish","qos","retain","exitClient","changeToPlay","info","getTurnInfo","e","onEmptyClientInEpic","getStateMessage","changeToPause","changeToEnd","_ref6","changeTimeout","changeToReady","deltaOrder","deltaEpic","toggleEnable","deltaClientEpic","nextEpic","orders","max","isEmpty","react_default","createElement","className","children","Component","Transition","Slide_default","assign","direction","AlertDialogSlide","handleSave","onSave","handleClose","onClose","Dialog_default","open","TransitionComponent","keepMounted","aria-labelledby","aria-describedby","DialogTitle_default","DialogContent_default","DialogActions_default","Button_default","onClick","color","React","FullScreenDialog","_this$props","classes","_this$props$title","title","fullScreen","AppBar_default","appBar","Toolbar_default","IconButton_default","aria-label","Close_default","Typography_default","variant","flex","withStyles","position","TIME_REMAIN_STEP","__showSnackbar","contentString","swalOptions","content","element","attributes","value","swal","__convertVisibleMS","stack","_saveClientFromStorage","sessionStorage","setItem","_loadClientFromStorage","getItem","defaultId","Math","random","substr","__replaceSpeechText","text","replaceObject","result","String","forEach","key","replace","App","gameState","settingDialog","turnTimeoutDialog","delayTurnMeSpeechText","turnMeSpeechText","timeoutSpeechText","timeoutTimer","timeRemain","timeRemainTimer","nextEpicDialog","wsProxy","createRef","audioComponent","handelChangeClient","bind","assertThisInitialized","renderClients","handelTurnTo","handleTurnYou","handleCloseTurnTimeoutDialog","clearTimeoutTimer","setTimeoutTimer","countdownTimer","playTTS","setState","speechText","arguments","current","q","encodeURIComponent","src","setAttribute","load","newTimeRemain","timer","setTimeout","callback","timeout","clearTimeout","turnMeText","handleOpenTurnTimeoutDialog","_this6","Items","ExpansionPanel_default","ExpansionPanelSummary_default","expandIcon","ExpandMore_default","classname","App-highlight","ExpansionPanelDetails_default","RemoveCircle_default","AddCircle_default","Switch_default","checked","ArrowUpward_default","ArrowDownward_default","exit","Delete_default","clientPanel","_this7","renderGameState","grow","Settings_default","Grid_default","container","spacing","item","xs","heading","Wifi_default","WifiOff_default","TextField_default","fullWidth","label","defaultValue","textField","margin","onChange","event","target","button","row","Avatar_default","purpleAvatar","src_WebSocketProxy","ref","handleOpenNextEpicDialog","SettingDialog","helperText","TimeoutFullScreen","bigButton","handleDelayTurnYou","nextClientEpic","handleCloseNextEpicDialog","theme","root","flexGrow","fontSize","typography","pxToRem","fontWeight","fontWeightRegular","marginLeft","unit","marginRight","width","height","backgroundColor","deepPurple","display","justifyContent","mixins","gutters","paddingTop","paddingBottom","Boolean","window","location","hostname","match","ReactDOM","render","src_App_0","document","getElementById","navigator","serviceWorker","then","registration","unregister"],"mappings":"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","file":"static/js/main.2f1f02c5.chunk.js","sourcesContent":["import mqtt from 'mqtt';\nimport React, { Component } from 'react';\nimport {object} from \"prop-types\";\nimport EventEmitter from 'eventemitter3'\nimport _ from 'lodash';\nimport ms from 'ms';\n\nconst DEFAULT_ORDER = 1;\nconst DEFAULT_EPIC = 1;\nconst DEFAULT_ENABLE = true;\nconst KEEP_ALIVE = ms('5h') / 1000; // sec\n\nexport enum GameStateType {\n    ready = 'GameStateTypeReady',\n    play = 'GameStateTypePlay',\n    pause = 'GameStateTypePause',\n    end = 'GameStateTypeEnd',\n}\n\nexport enum MessageType {\n    unknown = 'unknown',\n    turnTo = 'turnTo',\n    gameStateChange = 'gameStateChange',\n}\n\nexport interface MqttClientMeta {\n    id: string,\n    name: string,\n    order: number,\n    epic: number,\n    enable: boolean,\n}\n\ninterface TurnInfo {\n    currentClientId: string,\n    nextClientId: string,\n}\n\ninterface MessageMeta {\n    clientId: string,\n    channel: string,\n}\n\nclass NodeMessage {\n    channel = '';\n    type?: MessageType = MessageType.unknown;\n    readonly clientId: string;\n    constructor({channel, type, clientId}: {channel: string, type?: MessageType, clientId: string}) {\n        this.channel = channel;\n        this.clientId = clientId;\n        if(this.type) {\n            this.type = type;\n        }\n    }\n    toObject() : object {\n        return {\n            type: this.type,\n            channel: this.channel,\n            clientId: this.clientId,\n        };\n    }\n    toString() : string {\n        return JSON.stringify(this.toObject());\n    }\n}\n\nclass GameContextMessage extends NodeMessage {\n    type = MessageType.gameStateChange;\n    state = GameStateType.ready;\n    clients: Array<MqttClientMeta> = [];\n    currentClientId: string = '';\n    thinkTimeOut: number = ms('5s');\n    delayTimeOut: number = ms('2s');\n    epic: number = DEFAULT_EPIC;\n\n    constructor(context: any) {\n        super(context);\n        if(context && context.state) {\n            this.state = context.state;\n        }\n\n        if(context && context.clients) {\n            this.clients = context.clients;\n        }\n\n        if(context && context.currentClientId) {\n            this.currentClientId = context.currentClientId;\n        }\n\n        if(context && context.thinkTimeOut) {\n            this.thinkTimeOut = context.thinkTimeOut;\n        }\n\n        if(context && context.delayTimeOut) {\n            this.delayTimeOut = context.delayTimeOut;\n        }\n\n        if(context && _.isNumber(context.epic)) {\n            this.epic = context.epic;\n        }\n    }\n    toObject() {\n        const org = super.toObject();\n        return {\n            ...org,\n            state: this.state,\n            clients: this.clients,\n            currentClientId: this.currentClientId,\n            thinkTimeOut: this.thinkTimeOut,\n            delayTimeOut: this.delayTimeOut,\n            epic: this.epic,\n        };\n    }\n    getHost() {\n        return this.clientId;\n    }\n}\n\nclass TurnToMessage extends NodeMessage {\n    type = MessageType.turnTo;\n    turnToClientId: string = '';\n    constructor(context: any) {\n        super(context);\n        if(context.turnToClientId) {\n            this.turnToClientId = context.turnToClientId;\n        }\n    }\n    toObject() {\n        const org = super.toObject();\n        return {...org, turnToClientId: this.turnToClientId};\n    }\n}\n\nclass GameStateManager {\n    channel = '';\n    clientId = '';\n    context: GameContextMessage = new GameContextMessage(this.getMeta());\n\n    constructor({channel, clientId} : MessageMeta) {\n        this.channel = channel;\n        this.clientId = clientId;\n\n        this.context =  new GameContextMessage(this.getMeta());\n    }\n\n    private getMeta(): MessageMeta {\n        return {\n            channel: this.channel,\n            clientId: this.clientId,\n        };\n    }\n\n    loadCurrentState(state: GameContextMessage) {\n        if(!(state instanceof GameContextMessage)) {\n            throw new Error('can not load current state');\n        }\n        this.context = state;\n        return this.context;\n    }\n    joinClient(clientId: string, clientName: string) {\n        const foundClient = _.find<MqttClientMeta>(this.context.clients, (client) => client.id === clientId);\n        if(!foundClient) {\n            this.context.clients.push({\n                id: clientId,\n                name: clientName,\n                order: this.context.clients.length + DEFAULT_ORDER,\n                epic: this.context.epic,\n                enable: DEFAULT_ENABLE,\n            });\n        }\n        return this.context;\n    }\n    exitClient(clientId: string) {\n        const foundClient = _.find<MqttClientMeta>(this.context.clients, (client) => client.id === clientId);\n        if(foundClient) {\n            _.pull(this.context.clients, foundClient);\n        }\n        return this.context;\n    }\n\n    getStateMessage(): string {\n        return this.context.toString();\n    }\n    changeToReady() {\n        this.context.state = GameStateType.ready;\n        return this.context;\n    }\n    changeToEnd() {\n        this.context.state = GameStateType.end;\n        return this.context;\n    }\n    changeToPause() {\n        this.context.state = GameStateType.pause;\n        return this.context;\n    }\n    changeToPlay() {\n        this.context.state = GameStateType.play;\n        return this.context;\n    }\n    changeTimeout({thinkTimeOut, delayTimeOut} : {thinkTimeOut: number, delayTimeOut: number}) {\n        this.context.thinkTimeOut = thinkTimeOut;\n        this.context.delayTimeOut = delayTimeOut;\n        return this.context;\n    }\n\n    /**\n     *\n     * @return {TurnInfo | undefined}\n     * @throws Error\n     */\n    getTurnInfo(): TurnInfo | undefined {\n        if(this.context.clients.length === 0) {\n            throw new Error('At least one client');\n        }\n\n        const currentClientId = this.context.currentClientId;\n\n        // candidate clients\n        const candidateClients = this.context.clients.filter(client => client.enable && (this.context.epic === client.epic));\n        if(candidateClients.length === 0) {\n            return;\n        }\n\n        let index = candidateClients.map(client => client.id).indexOf(currentClientId);\n        index = (index === -1) ? 0 : index;\n\n        const clientLength = candidateClients.length;\n        return {\n            currentClientId: candidateClients[index].id,\n            nextClientId: candidateClients[(index + 1) % clientLength].id,\n        }\n    }\n    deltaOrder(clientId: string, delta: number) {\n        const foundClient = _.find(this.context.clients, client => client.id === clientId);\n        if(!foundClient) {\n            console.log(`[deltaOrder] Can not find ${clientId}`);\n            return this.context;\n        }\n        foundClient.order += delta;\n\n        this.context.clients = this.context.clients.sort((a, b) => a.epic - b.epic || a.order - b.order);\n        return this.context;\n    }\n    deltaEpic(delta: number) {\n        this.context.epic += delta;\n        return this.context;\n    }\n    deltaClientEpic(clientId: string, delta: number, order?: number) {\n        const foundClient = _.find(this.context.clients, client => client.id === clientId);\n        if(!foundClient) {\n            console.log(`[deltaClientEpic] Can not find ${clientId}`);\n            return this.context;\n        }\n\n        foundClient.epic += delta;\n        if(_.isNumber(order)) {\n            foundClient.order = order;\n        }\n\n        this.context.clients = this.context.clients.sort((a, b) => a.epic - b.epic || a.order - b.order);\n        return this.context;\n    }\n    toggleEnable(clientId: string) {\n        const foundClient = _.find(this.context.clients, client => client.id === clientId);\n        if(!foundClient) {\n            console.log(`[deltaOrder] Can not find ${clientId}`);\n            return;\n        }\n        foundClient.enable = !foundClient.enable;\n        return this.context;\n    }\n}\n\nclass MessageFactory {\n    channel = '';\n    clientId = '';\n    constructor({channel, clientId} : MessageMeta) {\n        this.channel = channel;\n        this.clientId = clientId;\n    }\n\n    private getMeta(): MessageMeta {\n        return {\n            channel: this.channel,\n            clientId: this.clientId,\n        };\n    }\n    turnTo(clientId: string): string {\n        const msg = new TurnToMessage({...this.getMeta(), turnToClientId: clientId});\n        return msg.toString();\n    }\n}\n\nclass MessageDispatcher extends EventEmitter {\n    next({topic, message}: {topic: string, message: any}) {\n        let data;\n        if( message instanceof object) {\n            data = message\n        } else {\n            data = JSON.parse(message.toString());\n        }\n\n        if(!data.type) {\n            this.emit('error', new Error('can not find message type'));\n            return;\n        }\n\n        const type = data.type;\n        this.emit('message', data);\n        this.emit(type, data);\n    }\n}\n\ninterface IWebSocketProxyProps {\n    onChangeClients?: (clients: Array<MqttClientMeta>) => void,\n    onChangeGameState?: (clients: GameStateType) => void,\n    onChangeThinkTimeOut?: (timeout: number) => void,\n    onChangeDelayTimeOut?: (timeout: number) => void,\n    onError?: (error: Error) => void,\n    onTurnYou?: () => void,\n    onNotTurnYou?: () => void,\n    onTurnTo?: (clientId: string) => void,\n    onConnected?: (mqttClient: mqtt.MqttClient) => void,\n    onChangeConnected?: (connected: boolean) => void,\n    onEmptyClientInEpic?: () => void,\n    clientId: string,\n    onChangeEpic?: (timeout: number) => void,\n}\n\ninterface IWebSocketProxyState {\n}\n\nclass WebSocketProxy extends Component<IWebSocketProxyProps, IWebSocketProxyState> {\n    client?: mqtt.MqttClient = undefined;\n    gameStateManager?: GameStateManager = undefined;\n    messageFactory?: MessageFactory = undefined;\n    messageDispatcher?: MessageDispatcher = undefined;\n    channel: string = 'testchannel';\n\n    constructor(props: any) {\n        super(props);\n    }\n\n    close() {\n        if(this.client) {\n            if(this.client.connected) {\n                this.client.end();\n            }\n            if(this.props.onChangeConnected) {\n                this.props.onChangeConnected(false);\n            }\n        }\n        this.client = undefined;\n    }\n\n    open(channel: string) {\n        this.close();\n\n        this.channel = channel;\n\n        const clientId = this.props.clientId;\n\n        const gameStateManager = new GameStateManager({channel, clientId});\n        const messageFactory = new MessageFactory({channel, clientId});\n        const dispatcher = new MessageDispatcher();\n\n        // Mqtt connection\n        const client = mqtt.connect('wss://aud.ssp.hinet.net:443/mqtt', {keepalive: KEEP_ALIVE, clientId});\n        client.on('connect',  () => {\n            client.subscribe(channel, (err) => {\n                if (err) {\n                    console.error(err);\n                }\n            });\n            if(this.props.onConnected) {\n                this.props.onConnected(client);\n            }\n            if(this.props.onChangeConnected) {\n                this.props.onChangeConnected(client.connected);\n            }\n        });\n        client.on('message', function (topic, message) {\n            dispatcher.next({topic, message});\n            // console.log(`topic = ${topic}, message = ${message}`)\n        });\n\n\n        // Event handler\n        dispatcher.on(MessageType.gameStateChange, (data) => {\n            // init game state\n            const newState = new GameContextMessage(data);\n\n            gameStateManager.loadCurrentState(newState);\n            console.log('==============================');\n            console.log('Channel by : ' + gameStateManager.context.channel);\n            console.log('thinkTimeOut : ' + ms(gameStateManager.context.thinkTimeOut));\n            console.log('delayTimeOut : ' + ms(gameStateManager.context.delayTimeOut));\n            console.log('Host by : ' + gameStateManager.context.getHost());\n            console.log('Game state : ' + gameStateManager.context.state);\n            console.log('Epic : ' + gameStateManager.context.epic);\n            console.log('Current : ' + gameStateManager.context.currentClientId);\n            console.log('Clients : \\n' + gameStateManager.context.clients.map(client => `${client.enable} - (${client.epic},${client.order}) - ${client.name} - ${client.id}`).join('\\n'));\n            console.log('==============================');\n\n            if(this.props.onChangeThinkTimeOut) {\n                this.props.onChangeThinkTimeOut(gameStateManager.context.thinkTimeOut);\n            }\n            if(this.props.onChangeDelayTimeOut) {\n                this.props.onChangeDelayTimeOut(gameStateManager.context.delayTimeOut);\n            }\n            if(this.props.onChangeClients) {\n                this.props.onChangeClients(gameStateManager.context.clients);\n            }\n            if(this.props.onChangeGameState) {\n                this.props.onChangeGameState(gameStateManager.context.state);\n            }\n            if(this.props.onTurnTo) {\n                this.props.onTurnTo(gameStateManager.context.currentClientId);\n            }\n            if(this.props.onChangeEpic) {\n                this.props.onChangeEpic(gameStateManager.context.epic);\n            }\n\n            // dispatch game state\n            if(gameStateManager.context.state === GameStateType.play) {\n                dispatcher.emit(GameStateType.play);\n            }\n            if(gameStateManager.context.state === GameStateType.ready) {\n                dispatcher.emit(GameStateType.ready);\n            }\n            if(gameStateManager.context.state === GameStateType.pause) {\n                dispatcher.emit(GameStateType.pause);\n            }\n            if(gameStateManager.context.state === GameStateType.end) {\n                dispatcher.emit(GameStateType.end);\n            }\n        });\n\n        dispatcher.on(MessageType.turnTo, (data) => {\n            const msg = new TurnToMessage(data);\n            if(this.props.onTurnTo) {\n                this.props.onTurnTo(msg.turnToClientId);\n            }\n\n            if(this.props.clientId === msg.turnToClientId) {\n                // console.log('turn to ==> ' + this.props.clientId);\n                if(this.props.onTurnYou) {\n                    this.props.onTurnYou();\n                }\n            } else {\n                if(this.props.onNotTurnYou) {\n                    this.props.onNotTurnYou();\n                }\n            }\n        });\n\n        // helper\n        this.client = client;\n        this.gameStateManager = gameStateManager;\n        this.messageFactory = messageFactory;\n        this.messageDispatcher = dispatcher;\n    }\n\n    join(clientId: string, clientName: string) {\n        if(this.gameStateManager && this.gameStateManager.context.state !== GameStateType.ready) {\n            const error = new Error('Only join client for \"ready\" state');\n            console.error(error);\n            if(this.props.onError) {\n                this.props.onError(error);\n            }\n            return;\n        }\n\n        if(this.client && this.gameStateManager) {\n            const state = this.gameStateManager.joinClient(clientId, clientName);\n            this.client.publish(this.channel, state.toString(), {qos:2, retain: true});\n        }\n    }\n\n    exit(clientId: string) {\n        if(this.client && this.gameStateManager) {\n            const state = this.gameStateManager.exitClient(clientId);\n            this.client.publish(this.channel, state.toString(), {qos:2, retain: true});\n        }\n    }\n\n    play() {\n        if(this.client && this.gameStateManager && this.messageFactory) {\n            const context = this.gameStateManager.changeToPlay();\n            this.client.publish(this.channel, this.messageFactory.turnTo(context.currentClientId), {qos:2});\n            this.client.publish(this.channel, context.toString(), {qos:2, retain: true})\n        }\n    }\n\n    next() {\n        if(this.client && this.gameStateManager) {\n            const context = this.gameStateManager.context;\n\n            let info = undefined;\n            try {\n                info = this.gameStateManager.getTurnInfo();\n            } catch (e) {\n                console.error(e);\n            }\n\n            if(info) {\n                if(this.messageFactory && info && context.currentClientId === '') { // First\n                    context.currentClientId = info ? info.currentClientId : '';\n                    this.client.publish(this.channel, this.messageFactory.turnTo(context.currentClientId), {qos:2});\n                } else if(this.messageFactory && info &&  context.currentClientId !== info.nextClientId) { // in playing\n                    context.currentClientId = info ? info.nextClientId : '';\n                    this.client.publish(this.channel, this.messageFactory.turnTo(context.currentClientId), {qos:2});\n                } else if(this.messageFactory && info &&  context.currentClientId && (context.currentClientId === info.nextClientId)) { // in playing\n                    context.currentClientId = info ? info.nextClientId : '';\n                    this.client.publish(this.channel, this.messageFactory.turnTo(context.currentClientId), {qos:2});\n                }\n            } else { // no client in the epic\n                if(this.props.onEmptyClientInEpic) {\n                    this.props.onEmptyClientInEpic();\n                }\n            }\n\n            // Change game context\n            this.client.publish(this.channel, this.gameStateManager.getStateMessage(), {qos:2, retain: true});\n        }\n    }\n\n    pause() {\n        if(this.client && this.gameStateManager) {\n            this.gameStateManager.changeToPause();\n            this.client.publish(this.channel, this.gameStateManager.getStateMessage(), {qos:2, retain: true})\n        }\n    }\n\n    end() {\n        if(this.client && this.gameStateManager) {\n            const context = this.gameStateManager.changeToEnd();\n            context.currentClientId = '';\n            this.client.publish(this.channel, this.gameStateManager.getStateMessage(), {qos:2, retain: true})\n        }\n    }\n\n    changeTimeout({thinkTimeOut, delayTimeOut} : {thinkTimeOut: number, delayTimeOut: number}) {\n        if(this.client && this.gameStateManager) {\n            const context = this.gameStateManager.changeTimeout({thinkTimeOut, delayTimeOut});\n            this.client.publish(this.channel, context.toString(), {qos:2, retain: true})\n        }\n    }\n\n    ready() {\n        if(this.client && this.gameStateManager) {\n            const context = this.gameStateManager.changeToReady();\n            context.currentClientId = '';\n            this.client.publish(this.channel, this.gameStateManager.getStateMessage(), {qos:2, retain: true})\n        }\n    }\n\n    deltaOrder(clientId: string, delta: number) {\n        if(this.client && this.gameStateManager) {\n            const context = this.gameStateManager.deltaOrder(clientId, delta);\n            this.client.publish(this.channel, this.gameStateManager.getStateMessage(), {qos:2, retain: true})\n        }\n    }\n\n    deltaEpic(delta: number) {\n        if(this.client && this.gameStateManager) {\n            const context = this.gameStateManager.deltaEpic(delta);\n            this.client.publish(this.channel, this.gameStateManager.getStateMessage(), {qos:2, retain: true})\n        }\n    }\n\n    toggleEnable(clientId: string) {\n        if(this.client && this.gameStateManager) {\n            const context = this.gameStateManager.toggleEnable(clientId);\n            this.client.publish(this.channel, this.gameStateManager.getStateMessage(), {qos:2, retain: true})\n        }\n    }\n\n    deltaClientEpic(clientId: string, delta: number) {\n        if(this.client && this.gameStateManager) {\n            const context = this.gameStateManager.deltaClientEpic(clientId, delta);\n            this.client.publish(this.channel, this.gameStateManager.getStateMessage(), {qos:2, retain: true})\n        }\n    }\n\n    nextClientEpic(clientId: string, delta: number) {\n        if(this.client && this.gameStateManager) {\n            const nextEpic  = this.gameStateManager.context.epic + delta;\n            const candidateClients = this.gameStateManager.context.clients.filter(client => client.enable && (nextEpic === client.epic));\n            const orders = candidateClients.map(client => client.order);\n\n            let max = _.isEmpty(orders) ? 0 : _.max(orders);\n            max = max || 0;\n            const order = max + DEFAULT_ORDER;\n\n            const context = this.gameStateManager.deltaClientEpic(clientId, delta, order);\n            this.client.publish(this.channel, this.gameStateManager.getStateMessage(), {qos:2, retain: true})\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"websocket-proxy\">\n                {this.props.children}\n            </div>\n        );\n    }\n}\n\nexport default WebSocketProxy;\n","import React from 'react';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Slide from '@material-ui/core/Slide';\n\nfunction Transition(props: any) {\n    return <Slide direction=\"up\" {...props} />;\n}\n\n\ninterface IAlertDialogSlide {\n    // classes: any,\n    open: boolean,\n    onClose?: () => void,\n    onSave?: () => void,\n}\n\n\nclass AlertDialogSlide extends React.Component<IAlertDialogSlide> {\n    handleSave = () => {\n        if(this.props.onSave) {\n            this.props.onSave();\n            this.handleClose();\n        }\n    };\n    handleClose = () => {\n        if(this.props.onClose) {\n            this.props.onClose();\n        }\n    };\n\n    render() {\n        return (\n            <div>\n                <Dialog\n                    open={this.props.open}\n                    TransitionComponent={Transition}\n                    keepMounted\n                    onClose={this.handleClose}\n                    aria-labelledby=\"alert-dialog-slide-title\"\n                    aria-describedby=\"alert-dialog-slide-description\"\n                >\n                    <DialogTitle id=\"alert-dialog-slide-title\">\n                        {\"設定\"}\n                    </DialogTitle>\n                    <DialogContent>\n                        {this.props.children}\n                    </DialogContent>\n                    <DialogActions>\n                        <Button onClick={this.handleClose} color=\"primary\">\n                            取消\n                        </Button>\n                        <Button onClick={this.handleSave} color=\"primary\">\n                            儲存\n                        </Button>\n                    </DialogActions>\n                </Dialog>\n            </div>\n        );\n    }\n}\n\nexport default AlertDialogSlide;\n","import React from 'react';\nimport { withStyles } from '@material-ui/core/styles';\nimport Dialog from '@material-ui/core/Dialog';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport IconButton from '@material-ui/core/IconButton';\nimport Typography from '@material-ui/core/Typography';\nimport CloseIcon from '@material-ui/icons/Close';\nimport Slide from '@material-ui/core/Slide';\n\nconst styles: any = {\n    appBar: {\n        position: 'relative',\n    },\n    flex: {\n        flex: 1,\n    },\n};\n\nfunction Transition(props: any) {\n    return <Slide direction=\"up\" {...props} />;\n}\n\ninterface IFullScreenDialogProps {\n    classes: any,\n    open: boolean,\n    title?: string\n    onClose?: () => void,\n}\n\nclass FullScreenDialog extends React.Component<IFullScreenDialogProps> {\n    handleClose = () => {\n        if(this.props.onClose) {\n            this.props.onClose();\n        }\n    };\n\n    render() {\n        const { classes, title = '' } = this.props;\n        return (\n            <div>\n                <Dialog\n                    fullScreen\n                    open={this.props.open}\n                    onClose={this.handleClose}\n                    TransitionComponent={Transition}\n                >\n                    <AppBar className={classes.appBar}>\n                        <Toolbar>\n                            <IconButton color=\"inherit\" onClick={this.handleClose} aria-label=\"Close\">\n                                <CloseIcon />\n                            </IconButton>\n                            <Typography variant=\"h6\" color=\"inherit\" className={classes.flex}>\n                                {title}\n                            </Typography>\n                        </Toolbar>\n                    </AppBar>\n                    {this.props.children}\n                </Dialog>\n            </div>\n        );\n    }\n}\n\nexport default withStyles(styles)(FullScreenDialog);\n","import React, {Component, Fragment} from 'react';\nimport classname from 'classnames';\nimport _ from 'lodash';\nimport { withStyles } from '@material-ui/core/styles';\nimport ms from 'ms';\nimport swal from 'sweetalert';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport IconButton from '@material-ui/core/IconButton';\nimport Typography from '@material-ui/core/Typography';\nimport NetworkOnIcon from '@material-ui/icons/Wifi';\nimport NetworkOffIcon from '@material-ui/icons/WifiOff';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport TextField from '@material-ui/core/TextField';\nimport ExpansionPanel from '@material-ui/core/ExpansionPanel';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport ArrowUpwardIcon from '@material-ui/icons/ArrowUpward';\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\nimport RemoveCircleIcon from '@material-ui/icons/RemoveCircle';\nimport Switch from '@material-ui/core/Switch';\nimport Avatar from '@material-ui/core/Avatar';\nimport deepPurple from '@material-ui/core/colors/deepPurple';\n\nimport './App.css';\nimport WebSocketProxy, {GameStateType, MqttClientMeta} from './WebSocketProxy';\nimport SettingDialog from './SettingDialog';\nimport TimeoutFullScreen from './TimeoutFullScreen';\n\nconst TIME_REMAIN_STEP = ms('1s');\n\nfunction __showSnackbar(title: string, contentString: string) {\n    const contentOptions = {\n        element: 'textarea',\n        attributes: {\n            value: contentString,\n        },\n    };\n    const swalOptions = {\n        title,\n        // icon: 'info',\n        content: contentOptions,\n        // buttons: [],\n        // timer: 3000,\n    };\n    swal(swalOptions);\n}\n\nfunction __convertVisibleMS(value: any) {\n    try {\n        return ms(value);\n    } catch (e) {\n        console.error(e);\n        __showSnackbar(e.message, e.stack);\n    }\n    return '';\n}\n\nfunction _saveClientFromStorage(client: {id: string, name: string}) {\n    sessionStorage.setItem('clientId', client.id);\n    sessionStorage.setItem('clientName', client.name);\n}\n\nfunction _loadClientFromStorage(): {id: string, name: string} {\n    const clientId = sessionStorage.getItem('clientId');\n    const clientName = sessionStorage.getItem('clientName');\n    const defaultId = 'you-turn_' + Math.random().toString(16).substr(2, 8);\n    const client =  {\n        id: clientId || defaultId,\n        name: clientName || defaultId,\n    };\n    _saveClientFromStorage(client);\n    return client;\n}\n\nconst styles = (theme: any) => ({\n    root: {\n        flexGrow: 1,\n    },\n    grow: {\n        flexGrow: 1,\n    },\n    heading: {\n        fontSize: theme.typography.pxToRem(15),\n        fontWeight: theme.typography.fontWeightRegular,\n    },\n    textField: {\n        marginLeft: theme.spacing.unit,\n        marginRight: theme.spacing.unit,\n    },\n    button: {\n        margin: theme.spacing.unit,\n    },\n    bigButton: {\n        margin: theme.spacing.unit,\n        width: \"95%\",\n        height: \"32%\",\n    },\n    purpleAvatar: {\n        margin: 10,\n        color: '#fff',\n        backgroundColor: deepPurple[500],\n    },\n    row: {\n        display: 'flex',\n        justifyContent: 'center',\n    },\n    clientPanel: {\n        ...theme.mixins.gutters(),\n        paddingTop: theme.spacing.unit * 2,\n        paddingBottom: theme.spacing.unit * 2,\n    }\n});\n\nfunction __replaceSpeechText(text: string, replaceObject: {name: string}) {\n    let result = String(text);\n    _.forEach(replaceObject, (value, key) => {\n        result = result.replace('${' + key + '}', value);\n    });\n    return result;\n}\n\ninterface IAppProps {\n    classes: any,\n}\n\ninterface IAppState {\n    clients: Array<MqttClientMeta>,\n    clientName: string,\n    clientId: string,\n    channel: string,\n    gameState: GameStateType,\n    currentClientId: string,\n    connected: boolean,\n    thinkTimeOut: number,\n    delayTimeOut: number,\n    settingDialog: boolean,\n    turnTimeoutDialog: boolean,\n    turnMeSpeechText: string,\n    timeoutSpeechText: string,\n    delayTurnMeSpeechText: string,\n    timeoutTimer?: NodeJS.Timeout,\n    timeRemain: number,\n    timeRemainTimer?: NodeJS.Timeout,\n    epic: number,\n    nextEpicDialog: boolean,\n}\n\nclass App extends Component<IAppProps, IAppState> {\n    wsProxy: React.RefObject<WebSocketProxy>;\n    audioComponent: React.RefObject<HTMLAudioElement>;\n    state = {\n        clients: [],\n        clientId: _loadClientFromStorage().id,\n        clientName: _loadClientFromStorage().name,\n        channel: 'testchannel',\n        gameState: GameStateType.end,\n        currentClientId: '',\n        connected: false,\n        thinkTimeOut: 0,\n        delayTimeOut: 0,\n        settingDialog: false,\n        turnTimeoutDialog: false,\n        delayTurnMeSpeechText: '${name} 再想一下',\n        turnMeSpeechText: '${name} 換你了',\n        timeoutSpeechText: '${name} 時間到了',\n        timeoutTimer: undefined,\n        timeRemain: 0,\n        timeRemainTimer: undefined,\n        epic: 0,\n        nextEpicDialog: false,\n    };\n\n    constructor(props: any) {\n        super(props);\n        this.wsProxy = React.createRef();\n        this.audioComponent = React.createRef();\n        this.handelChangeClient = this.handelChangeClient.bind(this);\n        this.renderClients = this.renderClients.bind(this);\n        this.handelTurnTo = this.handelTurnTo.bind(this);\n        this.handleTurnYou = this.handleTurnYou.bind(this);\n        this.handleCloseTurnTimeoutDialog = this.handleCloseTurnTimeoutDialog.bind(this);\n        this.clearTimeoutTimer = this.clearTimeoutTimer.bind(this);\n        this.setTimeoutTimer = this.setTimeoutTimer.bind(this);\n        this.countdownTimer = this.countdownTimer.bind(this);\n        this.playTTS = this.playTTS.bind(this);\n    }\n\n    componentDidMount() {\n        // Auto connected\n        // if(this.wsProxy.current) {\n        //     this.wsProxy.current.open(this.state.channel);\n        // }\n    }\n\n    handelChangeClient(clients: Array<MqttClientMeta>) {\n        this.setState(() => ({clients}));\n    }\n\n    handelTurnTo(clientId: string) {\n        this.setState(() => ({currentClientId: clientId}));\n    }\n\n    handleCloseTurnTimeoutDialog() {\n        this.setState(() => ({turnTimeoutDialog: false}));\n    }\n    handleOpenTurnTimeoutDialog() {\n        this.setState(() => ({turnTimeoutDialog: true}));\n    }\n    handleCloseNextEpicDialog() {\n        this.setState(() => ({nextEpicDialog: false}));\n    }\n    handleOpenNextEpicDialog() {\n        this.setState(() => ({nextEpicDialog: true}));\n    }\n\n    playTTS(speechText: string, timeout:number = 0) {\n        if(this.state.gameState !== GameStateType.play) {\n            return;\n        }\n\n        // play\n        if(this.audioComponent.current) {\n            const q = encodeURIComponent(speechText);\n            // const src = 'http://translate.google.com/translate_tts?ie=UTF-8&total=1&idx=0&textlen=32&client=tw-ob&tl=en-gb&q=' + q;\n            // const src = 'http://translate.google.com/translate_tts?ie=UTF-8&total=1&idx=0&client=tw-ob&tl=zh-tw&q=' + q;\n            const src = `https://google-translate-proxy.herokuapp.com/api/tts?query=${q}&language=zh-TW&speed=0.5`;\n            this.audioComponent.current.setAttribute('src',  src);\n            this.audioComponent.current.load();\n            this.audioComponent.current.play();\n        }\n    }\n\n    countdownTimer(timeRemain: number) {\n        const newTimeRemain = timeRemain - TIME_REMAIN_STEP;\n\n        const timer = setTimeout(() => {\n            if(newTimeRemain > 0) {\n                this.countdownTimer(newTimeRemain)\n            } else {\n                this.setState(() => ({\n                    timeRemain: 0,\n                    timeRemainTimer: undefined,\n                }));\n            }\n        }, TIME_REMAIN_STEP);\n\n        this.setState(() => ({\n            timeRemain,\n            timeRemainTimer: timer,\n        }));\n    }\n\n    setTimeoutTimer(callback: () => void, timeout: number) {\n        if(this.state.gameState !== GameStateType.play) {\n            return;\n        }\n\n        this.clearTimeoutTimer(() => {\n            const timeoutTimer = setTimeout(callback, timeout);\n            this.countdownTimer(timeout);\n            this.setState(() => ({\n                timeoutTimer,\n                timeRemain: timeout,\n            }));\n        });\n    }\n\n    clearTimeoutTimer(callback?: () => void) {\n        // timeoutTimer\n        if(this.state.timeoutTimer) {\n            clearTimeout(this.state.timeoutTimer);\n        }\n\n        // timeRemainTimer\n        if(this.state.timeRemainTimer) {\n            clearTimeout(this.state.timeRemainTimer);\n        }\n\n        this.setState(() => ({\n            timeoutTimer: undefined,\n            timeRemainTimer: undefined,\n        }), callback);\n    }\n\n    handleTurnYou(timeout = this.state.thinkTimeOut) {\n        if(this.state.gameState !== GameStateType.play) {\n            return;\n        }\n\n        const clientName = this.state.clientName;\n\n        // Show: turn me\n        console.log('Turn me: ' + clientName);\n        const turnMeText = __replaceSpeechText(this.state.turnMeSpeechText,{name: clientName});\n        this.playTTS(turnMeText);\n\n        this.handleOpenTurnTimeoutDialog();\n\n        // Show: timeout\n        this.setTimeoutTimer(() => {\n            const speechText = __replaceSpeechText(this.state.timeoutSpeechText,{name: clientName});\n            this.playTTS(speechText);\n        }, timeout);\n    }\n\n    handleDelayTurnYou(timeout = this.state.delayTimeOut) {\n        if(this.state.gameState !== GameStateType.play) {\n            return;\n        }\n\n        const clientName = this.state.clientName;\n\n        // Show: turn me\n        const turnMeText = __replaceSpeechText(this.state.delayTurnMeSpeechText,{name: clientName});\n        this.playTTS(turnMeText);\n\n        // Show: timeout\n        this.setTimeoutTimer(() => {\n            const speechText = __replaceSpeechText(this.state.timeoutSpeechText,{name: clientName});\n            this.playTTS(speechText);\n        }, timeout);\n    }\n\n    renderClients(clients: Array<MqttClientMeta>) {\n        const {classes} = this.props;\n        const Items: any[] = [];\n        clients.forEach(client => {\n            Items.push((\n                <ExpansionPanel key={client.id}>\n                    <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                        <Typography variant=\"body1\">\n                            <span className={classname({'App-highlight': (client.id === this.state.currentClientId)})}>({client.epic},{client.order}) {client.name} - {client.id}</span>\n                        </Typography>\n                    </ExpansionPanelSummary>\n                    <ExpansionPanelDetails>\n                        <div>\n                            <IconButton onClick={() => {\n                                this.wsProxy.current && this.wsProxy.current.deltaClientEpic(client.id,-1);\n                            }}>\n                                <RemoveCircleIcon />\n                            </IconButton>\n                            <IconButton onClick={() => {\n                                this.wsProxy.current && this.wsProxy.current.deltaClientEpic(client.id,1);\n                            }}>\n                                <AddCircleIcon />\n                            </IconButton>\n                            <Switch\n                                checked={client.enable}\n                                onClick={() => {\n                                    this.wsProxy.current && this.wsProxy.current.toggleEnable(client.id);\n                                }}\n                                value={client.enable}\n                            />\n                            <IconButton onClick={() => {\n                                this.wsProxy.current && this.wsProxy.current.deltaOrder(client.id, -1);\n                            }}>\n                                <ArrowUpwardIcon />\n                            </IconButton>\n                            <IconButton onClick={() => {\n                                this.wsProxy.current && this.wsProxy.current.deltaOrder(client.id, 1);\n                            }}>\n                                <ArrowDownwardIcon />\n                            </IconButton>\n                            <IconButton onClick={() => {\n                                this.wsProxy.current && this.wsProxy.current.exit(client.id);\n                            }}>\n                                <DeleteIcon />\n                            </IconButton>\n                        </div>\n                    </ExpansionPanelDetails>\n                </ExpansionPanel>));\n        });\n\n        return (\n            <div className={classes.clientPanel}>\n                {Items}\n            </div>\n        );\n    }\n\n    renderGameState(state: GameStateType) {\n        if(state === GameStateType.play) {\n            return \"Play\";\n        }\n        if(state === GameStateType.ready) {\n            return \"Ready\";\n        }\n        if(state === GameStateType.end) {\n            return \"End\";\n        }\n        if(state === GameStateType.pause) {\n            return \"Pause\";\n        }\n        return \"End\";\n    }\n\n    render() {\n        const {classes} = this.props;\n        return (\n            <div className=\"App\">\n                <AppBar position=\"static\">\n                    <Toolbar>\n                        {this.renderGameState(this.state.gameState)}\n                        <Typography variant=\"title\" color=\"inherit\" className={classes.grow}>\n                            {this.state.clientName}\n                        </Typography>\n                        <Typography variant=\"caption\" color=\"inherit\" className={classes.grow}>\n                            {this.state.clientId}\n                        </Typography>\n                        {this.state.connected && <IconButton color=\"inherit\" onClick={()=>{\n                            this.setState(() => ({settingDialog: true}));\n                        }}><SettingsIcon/></IconButton>}\n                    </Toolbar>\n                </AppBar>\n                <Grid container spacing={16}>\n                    <Grid item xs={12}>\n                        <ExpansionPanel>\n                            <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                                <Typography className={classes.heading}>\n                                    {this.state.connected ? <NetworkOnIcon/> : <NetworkOffIcon/>}\n                                    連線\n                                </Typography>\n                            </ExpansionPanelSummary>\n                            <ExpansionPanelDetails>\n                                <Grid container spacing={16}>\n                                    <Grid item xs={12}>\n                                        <TextField\n                                            id=\"network-channel\"\n                                            fullWidth\n                                            label=\"Channel\"\n                                            value={this.state.channel}\n                                            defaultValue={this.state.channel}\n                                            className={classes.textField}\n                                            margin=\"normal\"\n                                            onChange={event => {\n                                                const value = event.target.value;\n                                                this.setState(() => ({channel: value}));\n                                            }}\n                                        />\n                                        <Button variant=\"contained\" color=\"primary\" className={classes.button} onClick={() => {\n                                            if(this.wsProxy.current) {\n                                                this.wsProxy.current.open(this.state.channel);\n                                            }\n                                        }}>\n                                            Open\n                                        </Button>\n                                        <Button variant=\"contained\" className={classes.button} onClick={() => {\n                                            if(this.wsProxy.current) {\n                                                this.wsProxy.current.exit(this.state.clientId);\n                                                this.wsProxy.current.close();\n                                            }\n                                        }}>\n                                            Close\n                                        </Button>\n                                    </Grid>\n                                    <Grid item xs={12}>\n                                        <TextField\n                                            id=\"game-name\"\n                                            fullWidth\n                                            label=\"名稱\"\n                                            value={this.state.clientName}\n                                            defaultValue={this.state.clientName}\n                                            className={classes.textField}\n                                            margin=\"normal\"\n                                            onChange={event => {\n                                                const value = event.target.value;\n                                                this.setState(() => ({clientName: value}));\n                                            }}\n                                        />\n                                        <Button variant=\"contained\" color=\"primary\" className={classes.button} onClick={() => {\n                                            if(this.wsProxy.current) {\n                                                _saveClientFromStorage({id: this.state.clientId, name: this.state.clientName});\n                                                this.wsProxy.current.join(this.state.clientId, this.state.clientName);\n                                            }\n                                        }}>\n                                            加入\n                                        </Button>\n                                    </Grid>\n                                </Grid>\n                            </ExpansionPanelDetails>\n                        </ExpansionPanel>\n                    </Grid>\n                    <Grid item xs={12}>\n                        <Button className={classes.button} onClick={() => {\n                            if(this.wsProxy.current) {\n                                this.wsProxy.current.ready();\n                            }\n                        }}>Ready</Button>\n                        <Button className={classes.button} onClick={() => {\n                            if(this.wsProxy.current) {\n                                this.wsProxy.current.end();\n                            }\n                        }}>End</Button>\n                        <Button className={classes.button} onClick={() => {\n                            if(this.wsProxy.current) {\n                                this.wsProxy.current.play();\n                            }\n                        }}>Play</Button>\n                        <Button className={classes.button} onClick={() => {\n                            if(this.wsProxy.current) {\n                                this.wsProxy.current.pause();\n                            }\n                        }}>Pause</Button>\n                        <Button className={classes.button} onClick={() => {\n                            if(this.wsProxy.current) {\n                                this.wsProxy.current.next();\n                            }\n                        }}>Next</Button>\n                    </Grid>\n                    <Grid item xs={12}>\n                        <div className={classes.row}>\n                            <IconButton onClick={() => {\n                                this.wsProxy.current && this.wsProxy.current.deltaEpic(-1);\n                            }}>\n                                <RemoveCircleIcon />\n                            </IconButton>\n                            <Avatar className={classes.purpleAvatar}>{this.state.epic}</Avatar>\n                            <IconButton onClick={() => {\n                                this.wsProxy.current && this.wsProxy.current.deltaEpic(1);\n                            }}>\n                                <AddCircleIcon />\n                            </IconButton>\n                        </div>\n                    </Grid>\n                    <Grid item xs={12}>\n                        {this.renderClients(this.state.clients)}\n                    </Grid>\n                </Grid>\n                <WebSocketProxy\n                    clientId={this.state.clientId}\n                    ref={this.wsProxy}\n                    onTurnTo={this.handelTurnTo}\n                    onChangeClients={this.handelChangeClient}\n                    onChangeGameState={state => {\n                        this.setState(() => ({gameState: state}));\n                    }}\n                    onTurnYou={this.handleTurnYou}\n                    onNotTurnYou={() => {\n                        this.clearTimeoutTimer();\n                        this.handleCloseTurnTimeoutDialog();\n                    }}\n                    onChangeConnected={connected => {\n                        this.setState(() => ({connected}));\n                    }}\n                    onChangeThinkTimeOut={timeout => {\n                        this.setState(() => ({thinkTimeOut: timeout}));\n                    }}\n                    onChangeDelayTimeOut={timeout => {\n                        this.setState(() => ({delayTimeOut: timeout}));\n                    }} onError={(e) => {__showSnackbar(e.message, e.stack || '');}}\n                    onChangeEpic={epic => {\n                        this.setState(() => ({epic}));\n                    }}\n                    onEmptyClientInEpic={() => {\n                        this.handleOpenNextEpicDialog();\n                    }} />\n                <audio id=\"player\" src=\"#\" ref={this.audioComponent}/>\n                <SettingDialog open={this.state.settingDialog} onClose={() => {\n                    this.setState(() => ({settingDialog: false}))\n                }} onSave={() => {\n                    if(this.wsProxy.current) {\n                        this.wsProxy.current.changeTimeout({\n                            thinkTimeOut: this.state.thinkTimeOut,\n                            delayTimeOut: this.state.delayTimeOut,\n                        });\n                    }\n                }}>\n                    <TextField\n                        id=\"setting-think-timeout\"\n                        fullWidth\n                        label=\"思考時間\"\n                        value={this.state.thinkTimeOut}\n                        defaultValue={this.state.thinkTimeOut}\n                        className={classes.textField}\n                        helperText={__convertVisibleMS(this.state.thinkTimeOut)}\n                        margin=\"normal\"\n                        onChange={event => {\n                            const value = event.target.value;\n                            this.setState(() => ({thinkTimeOut: +value}));\n                        }}\n                    />\n                    <TextField\n                        id=\"setting-delay-timeout\"\n                        fullWidth\n                        label=\"延時時間\"\n                        value={this.state.delayTimeOut}\n                        defaultValue={this.state.delayTimeOut}\n                        className={classes.textField}\n                        helperText={__convertVisibleMS(this.state.delayTimeOut)}\n                        margin=\"normal\"\n                        onChange={event => {\n                            const value = event.target.value;\n                            this.setState(() => ({delayTimeOut: +value}));\n                        }}\n                    />\n                    <TextField\n                        fullWidth\n                        label=\"「換你」語音樣版\"\n                        value={this.state.turnMeSpeechText}\n                        defaultValue={this.state.turnMeSpeechText}\n                        className={classes.textField}\n                        helperText={'${name}: 名稱'}\n                        margin=\"normal\"\n                        onChange={event => {\n                            const value = event.target.value;\n                            this.setState(() => ({turnMeSpeechText: value}));\n                        }}\n                    />\n                    <TextField\n                        fullWidth\n                        label=\"「到時」語音樣版\"\n                        value={this.state.timeoutSpeechText}\n                        defaultValue={this.state.timeoutSpeechText}\n                        className={classes.textField}\n                        helperText={'${name}: 名稱'}\n                        margin=\"normal\"\n                        onChange={event => {\n                            const value = event.target.value;\n                            this.setState(() => ({timeoutSpeechText: value}));\n                        }}\n                    />\n                    <TextField\n                        fullWidth\n                        label=\"「延時」語音樣版\"\n                        value={this.state.delayTurnMeSpeechText}\n                        defaultValue={this.state.delayTurnMeSpeechText}\n                        className={classes.textField}\n                        helperText={'${name}: 名稱'}\n                        margin=\"normal\"\n                        onChange={event => {\n                            const value = event.target.value;\n                            this.setState(() => ({delayTurnMeSpeechText: value}));\n                        }}\n                    />\n                </SettingDialog>\n                <TimeoutFullScreen title={'換你:' + ms(this.state.timeRemain)} open={this.state.turnTimeoutDialog} onClose={this.handleCloseTurnTimeoutDialog}>\n                    <Button className={classes.bigButton} variant=\"contained\" onClick={() => {\n                        this.clearTimeoutTimer();\n                        this.handleDelayTurnYou();\n                    }}>\n                        再一下\n                    </Button>\n                    <Button className={classes.bigButton} variant=\"contained\" color=\"primary\" onClick={() => {\n                        this.clearTimeoutTimer();\n                        if(this.wsProxy.current) {\n                            this.wsProxy.current.next();\n                        }\n                        this.handleCloseTurnTimeoutDialog();\n                    }}>\n                        下一位\n                    </Button>\n                    <Button className={classes.bigButton} variant=\"contained\" color=\"secondary\" onClick={() => {\n                        this.clearTimeoutTimer();\n                        if(this.wsProxy.current) {\n                            this.wsProxy.current.nextClientEpic(this.state.clientId, 1);\n                            this.wsProxy.current.next();\n                        }\n                        this.handleCloseTurnTimeoutDialog();\n                    }}>\n                        進入下回合並下一位\n                    </Button>\n                </TimeoutFullScreen>\n                <TimeoutFullScreen title={'下一回合'} open={this.state.nextEpicDialog} onClose={this.handleCloseNextEpicDialog}>\n                    <Button className={classes.bigButton} variant=\"contained\" color=\"primary\" onClick={() => {\n                        this.wsProxy.current && this.wsProxy.current.deltaEpic(1);\n                        this.wsProxy.current && this.wsProxy.current.next();\n                        this.handleCloseNextEpicDialog();\n                    }}>\n                        開始下回合\n                    </Button>\n\n                </TimeoutFullScreen>\n            </div>\n        );\n    }\n}\n\nexport default withStyles(styles)(App);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}